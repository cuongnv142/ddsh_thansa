function Tooltip(opts){this.setValues(opts);this.map_=opts.map;var div=this.div_=document.createElement("div");div.className="tooltip";this.markerDragging=false;}Tooltip.prototype={draw:function(){},padding:20,visible_changed:function(){var vis=this.get("visible");this.div_.style.visibility=vis?"visible":"hidden";},getPos:function(e){var projection=this.getProjection();var pixel=projection.fromLatLngToDivPixel(e.latLng);var div=this.div_;var posX=pixel.x;var posY=pixel.y;var menuwidth=div.offsetWidth;var menuheight=div.offsetHeight;var boundsNE=this.map_.getBounds().getNorthEast();boundsNE.pixel=projection.fromLatLngToDivPixel(boundsNE);if(menuwidth+posX>boundsNE.pixel.x){posX-=menuwidth;}posX=posX-(menuwidth/2);if(posY-menuheight>0){posY=posY-this.padding-menuheight;}div.style.left=posX+"px";div.style.top=posY+"px";if(!this.markerDragging){this.set("visible",true);}},getPos2:function(latLng){var projection=this.getProjection();var pixel=projection.fromLatLngToDivPixel(latLng);var div=this.div_;var posX=pixel.x;var posY=pixel.y;var menuwidth=div.offsetWidth;var menuheight=div.offsetHeight;var boundsNE=this.map_.getBounds().getNorthEast();boundsNE.pixel=projection.fromLatLngToDivPixel(boundsNE);var boundsSW=this.map_.getBounds().getSouthWest();boundsSW.pixel=projection.fromLatLngToDivPixel(boundsSW);posX=posX-(menuwidth/2);if(posX<boundsSW.pixel.x){posX=boundsSW.pixel.x;}else if(menuwidth+posX>boundsNE.pixel.x){posX=posX-(menuwidth+posX-boundsNE.pixel.x);}if(posY-menuheight>0){posY=posY-this.padding-menuheight;}div.style.left=posX+"px";div.style.top=posY+"px";if(!this.markerDragging){this.set("visible",true);}},addTip:function(marker){var me=this;me.marker_=marker;this.padding=marker.getIcon().size.height;me.bindTo("text",me.marker_,"tooltip");var g=google.maps.event;var div=me.div_;div.innerHTML=me.get("text").toString();me.marker_.setTitle(null);me.set("visible",false);me.getPanes().floatPane.appendChild(this.div_);g.addListener(me.marker_,"dragend",function(){me.markerDragging=false;});me.listeners=[g.addListener(me.marker_,"position_changed",function(){me.markerDragging=true;me.set("visible",false);}),g.addListener(me.map_,"mousemove",function(e){})];},removeTip:function(){if(this.listeners){for(var i=0,listener;listener=this.listeners[i];i++){google.maps.event.removeListener(listener);}delete this.listeners;}var parent=this.div_.parentNode;if(parent)parent.removeChild(this.div_);}};function inherit(addTo,getFrom){var from=getFrom.prototype;var to=addTo.prototype;for(var prop in from){if(typeof to[prop]=="undefined")to[prop]=from[prop];}}inherit(Tooltip,google.maps.OverlayView);